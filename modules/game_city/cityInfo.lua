local areas = {
    --Saffron
	{from = {x = 1047, y = 1041, z = 7}, to = {x = 1061, y = 1054, z = 7}, priority = 0, name = 'CP de Saffron'},
	{from = {x = 1062, y = 1042, z = 7}, to = {x = 1074, y = 1048, z = 7}, priority = 0, name = 'CP de Saffron'},
	{from = {x = 1072, y = 1036, z = 7}, to = {x = 1076, y = 1044, z = 7}, priority = 0, name = 'CP de Saffron'},
	{from = {x = 1079, y = 1036, z = 7}, to = {x = 1087, y = 1045, z = 7}, priority = 0, name = 'Mark - Loja'},
	{from = {x = 1044, y = 1090, z = 7}, to = {x = 1056, y = 1102, z = 7}, priority = 0, name = 'Shopping de Saffron'},
	{from = {x = 1064, y = 1048, z = 7}, to = {x = 1075, y = 1062, z = 7}, priority = 0, name = 'Cidade de Saffron'},
	{from = {x = 999, y = 1018, z = 7}, to = {x = 1113, y = 1110, z = 7}, priority = 0, name = 'Cidade de Saffron'},
	--Cerulean
	{from = {x = 1077, y = 934, z = 7}, to = {x = 1085, y = 939, z = 7}, priority = 0, name = 'Mark - Loja'},
	{from = {x = 1055, y = 895, z = 7}, to = {x = 1067, y = 908, z = 7}, priority = 0, name = 'Centro Pokemon - Cerulean'},
	{from = {x = 1001, y = 869, z = 7}, to = {x = 1100, y = 944, z = 7}, priority = 0, name = 'Cidade de Cerulean'},
	--Lavender
	{from = {x = 1223, y = 1048, z = 7}, to = {x = 1229, y = 1054, z = 7}, priority = 0, name = 'Mark - Loja'},
	{from = {x = 1177, y = 1037, z = 8}, to = {x = 1205, y = 1046, z = 8}, priority = 0, name = 'CP de Lavender'},
	{from = {x = 1191, y = 1027, z = 7}, to = {x = 1244, y = 1066, z = 7}, priority = 0, name = 'Cidade de Lavender'},
	--Pewter
	{from = {x = 712, y = 841, z = 7}, to = {x = 728, y = 859, z = 7}, priority = 0, name = 'CP de Pewter'},
	{from = {x = 745, y = 847, z = 7}, to = {x = 755, y = 854, z = 7}, priority = 0, name = 'Mark - Loja'},
	{from = {x = 687, y = 816, z = 7}, to = {x = 766, y = 888, z = 7}, priority = 0, name = 'Cidade de Pewter'},
	--Viridian
	{from = {x = 699, y = 1061, z = 7}, to = {x = 714, y = 1091, z = 7}, priority = 0, name = 'CP de Viridian'},
	{from = {x = 735, y = 1096, z = 7}, to = {x = 742, y = 1102, z = 7}, priority = 0, name = 'Mark - Loja'},
	{from = {x = 699, y = 1061, z = 7}, to = {x = 787, y = 1116, z = 7}, priority = 0, name = 'Cidade de Viridian'},
	--Pallet
	{from = {x = 635, y = 1198, z = 7}, to = {x = 667, y = 1228, z = 7}, priority = 0, name = 'Coliseu - Torneio'},
	{from = {x = 644, y = 1272, z = 7}, to = {x = 727, y = 1301, z = 7}, priority = 0, name = 'Golden Arena'},
	{from = {x = 667, y = 1180, z = 7}, to = {x = 750, y = 1254, z = 7}, priority = 0, name = 'Cidade de Pallet'},
	{from = {x = 656, y = 1160, z = 7}, to = {x = 690, y = 1194, z = 7}, priority = 0, name = 'Cidade de Pallet'},
	--Cinnabar
	{from = {x = 860, y = 1433, z = 7}, to = {x = 868, y = 1442, z = 7}, priority = 0, name = 'Mark - Loja'},
	{from = {x = 843, y = 1394, z = 7}, to = {x = 858, y = 1411, z = 7}, priority = 0, name = 'CP de Cinnabar'},
	{from = {x = 792, y = 1362, z = 7}, to = {x = 874, y = 1448, z = 7}, priority = 0, name = 'Cidade de Cinnabar'},
	--Celadon
	{from = {x = 858, y = 1093, z = 6}, to = {x = 866, y = 1103, z = 6}, priority = 0, name = 'CP de Celadon'},
	{from = {x = 869, y = 1130, z = 6}, to = {x = 878, y = 1137, z = 6}, priority = 0, name = 'Mark - Loja'},
	{from = {x = 885, y = 1080, z = 6}, to = {x = 895, y = 1092, z = 6}, priority = 0, name = 'Cassino'},
	{from = {x = 846, y = 1076, z = 6}, to = {x = 941, y = 1145, z = 6}, priority = 0, name = 'Cidade de Celadon'},
	--Vermilion
	{from = {x = 1066, y = 1231, z = 7}, to = {x = 1081, y = 1246, z = 7}, priority = 0, name = 'CP de Vermilion'},
	{from = {x = 1038, y = 1205, z = 7}, to = {x = 1046, y = 1214, z = 7}, priority = 0, name = 'Mark - Loja'},
	{from = {x = 1008, y = 1194, z = 7}, to = {x = 1109, y = 1299, z = 7}, priority = 0, name = 'Cidade de Vermilion'},
	--Fuchsia
	{from = {x = 1208, y = 1319, z = 7}, to = {x = 1220, y = 1328, z = 7}, priority = 0, name = 'CP de Fuchsia'},
	{from = {x = 1224, y = 1361, z = 7}, to = {x = 1232, y = 1369, z = 7}, priority = 0, name = 'Mark - Loja'},
	{from = {x = 1147, y = 1402, z = 7}, to = {x = 1160, y = 1417, z = 7}, priority = 0, name = 'Saffari Zone'},
	{from = {x = 1158, y = 1266, z = 7}, to = {x = 1241, y = 1425, z = 7}, priority = 0, name = 'Cidade de Fuchsia'},
	--Snow
	{from = {x = 1422, y = 1567, z = 7}, to = {x = 1430, y = 1576, z = 7}, priority = 0, name = 'Mark - Loja'},
	{from = {x = 1422, y = 1595, z = 6}, to = {x = 1438, y = 1604, z = 6}, priority = 0, name = 'CP de Snow'},
    {from = {x = 1427, y = 1604, z = 6}, to = {x = 1433, y = 1606, z = 6}, priority = 0, name = 'CP de Snow'},
	{from = {x = 1382, y = 1540, z = 7}, to = {x = 1486, y = 1649, z = 7}, priority = 0, name = 'Cidade de Snow'},
	}
local area = nil
local intervalo = 0
local duracao = 8
local retorno = 0
local eventAnimation = nil
local check = true
function isInRange(pos, fromPos, toPos)
    return
        pos.x>=fromPos.x and
        pos.y>=fromPos.y and
        pos.z>=fromPos.z and
        pos.x<=toPos.x and
        pos.y<=toPos.y and
        pos.z<=toPos.z
end

function init()
	placa = g_ui.displayUI('cityInfo', modules.game_interface.getRootPanel())
	placa:setVisible(false) 
	
	placaLabel = placa:getChildById('nome')
	
	connect(g_game, { onGameStart = updatePosition})
	connect(g_game, { onGameStart = AdjustSize})
	
	connect(LocalPlayer, {
		onPositionChange = updatePosition
	})
end
function AdjustSize()
	local top = (g_window.getHeight()/2) - 65
	placa:setMarginTop(-top)
end

function terminate()
	placa:destroy()
end

function updatePosition()
	local player = g_game.getLocalPlayer()
	if not player then
		return 
	end
	local pos = player:getPosition()
	if not pos then return end
	check = false
	local prioridade = nil
	for i = 1, #areas do
		if isInRange(pos, areas[i].from, areas[i].to) then
			if prioridade == nil then
				prioridade = areas[i].priority
				Table = areas[i]
			end
			
			if areas[i].priority > prioridade then
				Table = areas[i]
				prioridade = areas[i].priority
			end
			check = true
		end
	end
	if check == true then
		if Table.name == area then
			return false
		else
			reset()
			area = Table.name
			retorno = 1
			placaLabel:setText(area) 
			eventAnimation = cycleEvent(function() showPlaca(retorno) end, 200)
			check = true
		end
	else
		reset()	
	end
end

function reset()
	area = nil
	removeEvent(eventAnimation)
	removeEvent(placa.fadeEvent)
	g_effects.fadeOut(placa, 0) 
	placa:setVisible(false)	
end
function showPlaca()
	if retorno == 1 then
		g_effects.fadeIn(placa, 500)
		retorno = 2
		removeEvent(eventAnimation)
		placa:setVisible(true)
		eventAnimation = cycleEvent(function() showPlaca(retorno) end, 5000)
		return
	elseif retorno == 2 then
		g_effects.fadeOut(placa, 500)
		retorno = 0
		removeEvent(eventAnimation)
	end
end
